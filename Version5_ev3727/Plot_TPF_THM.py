import numpy as np 
import matplotlib.pyplot as plt
import pandas as pd 

def readTPF(file_path):
    # Charger les données
    df = pd.read_csv(file_path, delimiter=',', skipinitialspace=True)
    z = df['zPosition']
    # Convertir les colonnes de température en float
    TempVap = df['TempVap'].astype(float)
    TempLiq = df['TempLiq'].astype(float)
    TempFuelC = df['TempFuelC'].astype(float)
    TempStru = df['TempStru'].astype(float)
    Void = df['Void'].astype(float)
    Pressure = df['Pressure'].astype(float)
    VelzVap = df['VelzVap'].astype(float)
    VelzLiq = df['VelzLiq'].astype(float)

    for i in range(len(z)):
        TempVap[i] = TempVap[i] + 273.15
        TempLiq[i] = TempLiq[i] + 273.15
        TempFuelC[i] = TempFuelC[i] + 273.15
        TempStru[i] = TempStru[i] + 273.15
        
    return z, TempVap, TempLiq, TempFuelC, TempStru, Void, Pressure, VelzVap, VelzLiq


# Données brutes sous forme de chaîne de caractères
raw_data_0 = """PCOOL:   7214343.00       7213741.50       7213140.50       7212540.00       7211939.50       7211339.50       7210739.50       7210140.50       7209541.00       7208942.50       7208344.00       7207746.00       7207148.00       7206550.50       7205953.50       7205356.50       7204760.00       7204164.00       7203568.00       7202972.50       7202377.50       7201782.50       7201188.00       7200594.00       7200000.00    
 VCOOL:   1.28856492       1.28961909       1.29067171       1.29173470       1.29279423       1.29386306       1.29492974       1.29600608       1.29708052       1.29816306       1.29924941       1.30033696       1.30142891       1.30252469       1.30362487       1.30472767       1.30583715       1.30694664       1.30806339       1.30918074       1.31030595       1.31143272       1.31256473       1.31369948       1.31483805    
 DCOOL:   769.617004       768.987915       768.360718       767.728455       767.099243       766.465576       765.834167       765.198181       764.564331       763.926758       763.287903       762.649597       762.009583       761.368408       760.726074       760.083130       759.437317       758.792603       758.144714       757.497742       756.847046       756.197144       755.544678       754.892456       754.237366    
 TCOOL:   543.329163       543.685608       544.039795       544.395996       544.749390       545.104248       545.456848       545.810913       546.162781       546.515686       546.868225       547.219421       547.570496       547.921143       548.271423       548.620972       548.971008       549.319336       549.668396       550.015747       550.364197       550.711121       551.058289       551.404175       551.750549    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000    
 TSAT:   561.028198       561.022522       561.016846       561.011169       561.005493       560.999817       560.994202       560.988525       560.982849       560.977173       560.971558       560.965881       560.960205       560.954590       560.948914       560.943298       560.937622       560.932007       560.926392       560.920715       560.915100       560.909485       560.903870       560.898254       560.892639    
 MUT:   9.80513869E-05   9.78959506E-05   9.77416494E-05   9.75866351E-05   9.74330032E-05   9.72788766E-05   9.71258851E-05   9.69723988E-05   9.68200038E-05   9.66672960E-05   9.65148793E-05   9.63631755E-05   9.62116537E-05   9.60604375E-05   9.59094905E-05   9.57589800E-05   9.56083750E-05   9.54586067E-05   9.53086346E-05   9.51594920E-05   9.50099784E-05   9.48612069E-05   9.47124281E-05   9.45642823E-05   9.44160056E-05
 HCOOL:   1186342.25       1188152.50       1189962.88       1191773.00       1193583.25       1195393.38       1197203.75       1199013.88       1200824.25       1202634.62       1204444.88       1206255.12       1208065.38       1209875.62       1211685.75       1213496.00       1215306.25       1217116.62       1218927.00       1220737.38       1222547.50       1224357.88       1226168.38       1227978.50       1229788.88    
"""
#friction churchill
raw_data_0c="""PCOOL:   7214343.00       7213742.00       7213140.50       7212540.00       7211939.50       7211339.50       7210740.00       7210140.50       7209541.00       7208942.50       7208344.00       7207746.00       7207148.00       7206550.50       7205953.50       7205356.50       7204760.00       7204164.00       7203568.00       7202972.50       7202377.50       7201782.50       7201188.00       7200594.00       7200000.00    
 VCOOL:   1.28856492       1.28961885       1.29067099       1.29173350       1.29279280       1.29386115       1.29492581       1.29600334       1.29707670       1.29816020       1.29924440       1.30033183       1.30142474       1.30251861       1.30361915       1.30472124       1.30582905       1.30693853       1.30805612       1.30917287       1.31029522       1.31142247       1.31255352       1.31368744       1.31482649    
 DCOOL:   769.617004       768.988037       768.361206       767.729187       767.100098       766.466675       765.836548       765.199768       764.566528       763.928406       763.290955       762.652588       762.012024       761.372070       760.729431       760.086975       759.442139       758.797363       758.149048       757.502319       756.853577       756.203308       755.551514       754.899231       754.244141    
 TCOOL:   543.329163       543.685486       544.039612       544.395630       544.748901       545.103638       545.455505       545.810059       546.161560       546.514771       546.866577       547.217773       547.569153       547.919189       548.269592       548.618835       548.968384       549.316833       549.666016       550.013367       550.360718       550.707764       551.054626       551.400635       551.746948    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000    
 TSAT:   561.028198       561.022522       561.016846       561.011169       561.005493       560.999817       560.994202       560.988525       560.982849       560.977173       560.971558       560.965881       560.960205       560.954590       560.948914       560.943298       560.937622       560.932007       560.926392       560.920715       560.915100       560.909485       560.903870       560.898254       560.892639    
 MUT:   9.80513869E-05   9.78960015E-05   9.77417294E-05   9.75867952E-05   9.74332143E-05   9.72791386E-05   9.71264599E-05   9.69727625E-05   9.68205277E-05   9.66676889E-05   9.65155923E-05   9.63638886E-05   9.62122285E-05   9.60612742E-05   9.59102836E-05   9.57599041E-05   9.56095028E-05   9.54596835E-05   9.53096533E-05   9.51605107E-05   9.50114627E-05   9.48626475E-05   9.47139924E-05   9.45657957E-05   9.44175481E-05
 HCOOL:   1186342.25       1188151.75       1189961.12       1191770.62       1193580.12       1195389.75       1197199.25       1199008.75       1200818.25       1202627.75       1204437.25       1206246.88       1208056.38       1209865.88       1211675.25       1213484.75       1215294.25       1217103.62       1218913.12       1220722.62       1222532.12       1224341.50       1226151.00       1227960.50       1229770.00    
"""

raw_data_1="""PCOOL:   7214648.00       7214045.50       7213444.00       7212843.00       7212243.00       7211643.50       7211045.00       7210447.50       7209850.50       7209254.50       7208659.50       7208065.00       7207471.50       7206879.00       7206287.00       7205696.00       7205105.50       7204516.50       7203904.50       7203277.00       7202641.00       7201996.00       7201342.00       7200678.50       7200000.00    
 VCOOL:   1.28936708       1.29203475       1.29472744       1.29744363       1.30018187       1.30294347       1.30572963       1.30854356       1.31137776       1.31424165       1.31712723       1.32004178       1.32298541       1.32595110       1.32894826       1.33197105       1.33502328       1.33810496       1.36738503       1.39379382       1.42038393       1.44739127       1.47522092       1.50430644       1.54363000    
 DCOOL:   769.139771       767.552063       765.953735       764.350098       762.741577       761.123962       759.499695       757.867188       756.227783       754.580444       752.926514       751.263733       749.595032       747.916931       746.230835       744.536621       742.834351       741.123718       725.253052       711.508911       698.185974       685.153870       672.212524       659.175476       642.646179    
 TCOOL:   543.600037       544.496338       545.392029       546.284119       547.172302       548.058777       548.942200       549.823303       550.701294       551.576660       552.448608       553.318176       554.183960       555.047424       555.907898       556.765320       557.619507       558.470581       559.239929       559.612610       559.967773       560.299805       560.599670       560.857605       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       1.99153032E-02   3.85453515E-02   5.66638596E-02   7.44655505E-02   9.22530144E-02  0.110310167      0.133895144    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       1.36515440E-03   2.72427336E-03   4.12707590E-03   5.58701716E-03   7.12896744E-03   8.78042728E-03   1.10237887E-02
 TSAT:   561.031128       561.025391       561.019714       561.014038       561.008362       561.002686       560.997070       560.991394       560.985779       560.980164       560.974487       560.968872       560.963257       560.957703       560.952087       560.946472       560.940918       560.935364       560.929565       560.923645       560.917603       560.911499       560.905334       560.899048       560.892639    
 MUT:   9.79334945E-05   9.75435323E-05   9.71548288E-05   9.67686137E-05   9.63849598E-05   9.60028556E-05   9.56228178E-05   9.52444752E-05   9.48681118E-05   9.44934436E-05   9.41207691E-05   9.37495715E-05   9.33803967E-05   9.30125534E-05   9.26462744E-05   9.22815234E-05   9.19183221E-05   9.15565470E-05   9.12295363E-05   9.10710078E-05   9.09199080E-05   9.07786234E-05   9.06509886E-05   9.05660272E-05   9.05685010E-05
 HCOOL:   1189104.12       1193676.38       1198248.62       1202820.88       1207393.12       1211965.38       1216537.62       1221110.00       1225682.25       1230254.38       1234826.62       1239398.88       1243971.25       1248543.50       1253115.75       1257687.88       1262260.00       1266832.25       1270870.00       1274895.00       1278887.88       1282838.88       1286737.12       1290571.12       1294104.50    
"""
#friction churchill
raw_data_1c="""PCOOL:   7214749.00       7214147.00       7213545.00       7212944.00       7212344.00       7211745.00       7211146.50       7210549.00       7209952.00       7209356.00       7208761.00       7208166.50       7207573.00       7206980.00       7206388.50       7205797.50       7205207.00       7204617.50       7204005.00       7203375.00       7202735.00       7202085.00       7201415.50       7200716.00       7200000.00    
 VCOOL:   1.28936708       1.29203343       1.29472661       1.29744279       1.30017984       1.30294120       1.30572653       1.30853975       1.31137395       1.31423688       1.31712162       1.32003784       1.32297611       1.32594383       1.32893908       1.33196247       1.33501458       1.33809519       1.36788917       1.39524591       1.42331851       1.45245349       1.49104238       1.54436016       1.59661555    
 DCOOL:   769.138184       767.550781       765.954285       764.350769       762.741760       761.125244       759.501587       757.868774       756.230225       754.583435       752.929565       751.267578       749.598755       747.921082       746.235352       744.541443       742.839478       741.129150       724.983459       710.770996       696.752258       682.775452       665.107117       642.146912       621.127625    
 TCOOL:   543.600952       544.497192       545.391846       546.283875       547.172302       548.058167       548.941284       549.822571       550.700073       551.575195       552.447144       553.316284       554.182129       555.045410       555.905701       556.762939       557.617065       558.468018       559.333740       559.797668       560.240173       560.655518       560.906006       560.899414       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       2.00579576E-02   3.91325913E-02   5.80414869E-02   7.70120323E-02  0.101706922      0.134595037      0.164703265    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       1.37762004E-03   2.77754315E-03   4.25683009E-03   5.83665399E-03   8.00748449E-03   1.10942414E-02   1.41817238E-02
 TSAT:   561.032043       561.026367       561.020691       561.015015       561.009338       561.003662       560.998047       560.992371       560.986755       560.981079       560.975464       560.969849       560.964233       560.958618       560.953064       560.947449       560.941895       560.936279       560.930481       560.924561       560.918518       560.912354       560.906006       560.899414       560.892639    
 MUT:   9.79331235E-05   9.75431903E-05   9.71549380E-05   9.67687520E-05   9.63849889E-05   9.60031539E-05   9.56232470E-05   9.52448245E-05   9.48686647E-05   9.44941057E-05   9.41214312E-05   9.37504155E-05   9.33812116E-05   9.30134483E-05   9.26472421E-05   9.22825711E-05   9.19193917E-05   9.15576748E-05   9.11897223E-05   9.09924347E-05   9.08042275E-05   9.06275382E-05   9.05633424E-05   9.05658817E-05   9.05685010E-05
 HCOOL:   1189104.12       1193675.62       1198247.00       1202818.38       1207389.75       1211961.25       1216532.50       1221104.00       1225675.38       1230246.75       1234818.12       1239389.38       1243960.75       1248532.25       1253103.50       1257675.00       1262246.25       1266817.62       1271388.88       1275960.25       1280531.62       1285102.88       1289674.25       1294245.50       1298817.00    
"""

raw_data_2 = """PCOOL:   7218490.50       7217886.00       7217283.50       7216682.00       7216082.50       7215484.50       7214888.00       7214293.00       7213669.00       7213027.50       7212372.00       7211692.50       7210962.00       7210208.00       7209429.50       7208624.50       7207792.00       7206931.00       7206039.50       7205117.00       7204162.00       7203174.00       7202151.50       7201093.50       7200000.00    
 VCOOL:   1.29069161       1.29607022       1.30154550       1.30711937       1.31279087       1.31856251       1.32444668       1.33043122       1.37155020       1.40824544       1.44733930       1.49761605       1.57779574       1.65457118       1.72843087       1.79976714       1.86890614       1.93608999       2.00155640       2.06548452       2.12803531       2.18933606       2.24951339       2.30867457       2.36689448    
 DCOOL:   768.350708       765.159058       761.940186       758.692566       755.414917       752.108276       748.768066       745.398499       723.054565       704.212708       685.193359       662.204102       628.527710       599.338684       573.717407       550.982422       530.624634       512.248901       495.548035       480.275940       466.234650       453.261353       441.222595       430.007172       419.521393    
 TCOOL:   544.048889       545.838013       547.615906       549.382812       551.138794       552.882629       554.616150       556.336365       558.244324       559.317444       560.299927       561.003174       560.996277       560.989136       560.981812       560.974182       560.966309       560.958191       560.949768       560.941040       560.932007       560.922668       560.912964       560.902954       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       2.55646799E-02   4.96743061E-02   7.44088888E-02  0.105639525      0.153887749      0.195707202      0.232415333      0.264988482      0.294155955      0.320483893      0.344412357      0.366293728      0.386411846      0.404999822      0.422248989      0.438318312      0.453342259    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       1.73225882E-03   3.54143186E-03   5.58217522E-03   8.37717205E-03   1.30662639E-02   1.76920220E-02   2.22650860E-02   2.67949924E-02   3.12888511E-02   3.57532725E-02   4.01930958E-02   4.46128249E-02   4.90161404E-02   5.34064472E-02   5.77864051E-02   6.21581823E-02   6.65238649E-02
 TSAT:   561.067383       561.061707       561.055969       561.050293       561.044678       561.039001       561.033386       561.027771       561.021851       561.015808       561.009583       561.003174       560.996277       560.989136       560.981812       560.974182       560.966309       560.958191       560.949768       560.941040       560.932007       560.922668       560.912964       560.902954       560.892639    
 MUT:   9.77393938E-05   9.69631583E-05   9.61953920E-05   9.54354982E-05   9.46829750E-05   9.39378660E-05   9.31989052E-05   9.24668930E-05   9.16559366E-05   9.11999086E-05   9.07823633E-05   9.05258348E-05   9.05284978E-05   9.05312481E-05   9.05340785E-05   9.05370252E-05   9.05400593E-05   9.05431953E-05   9.05464476E-05   9.05498164E-05   9.05533016E-05   9.05569032E-05   9.05606576E-05   9.05645211E-05   9.05685010E-05
 HCOOL:   1193675.62       1202819.25       1211963.00       1221106.62       1230250.25       1239394.00       1248537.75       1257681.38       1266142.62       1274549.25       1282832.25       1290741.12       1297698.75       1304560.88       1311344.00       1318061.62       1324724.75       1331343.00       1337923.62       1344473.25       1350997.38       1357501.00       1363988.00       1370461.88       1376925.75    
"""
#friction churchill
raw_data_2c = """PCOOL:   7220179.00       7219575.00       7218972.00       7218371.00       7217771.00       7217173.00       7216576.50       7215982.00       7215356.50       7214711.50       7214051.00       7213325.50       7212552.00       7211745.50       7210903.50       7210022.50       7209100.50       7208135.00       7207124.00       7206065.50       7204957.50       7203799.00       7202587.50       7201321.50       7200000.00    
 VCOOL:   1.29068792       1.29606915       1.30154288       1.30711448       1.31278431       1.31855631       1.32443774       1.33042383       1.37218606       1.41015458       1.45152760       1.53730083       1.64058197       1.74008000       1.83617616       1.92921031       2.01948595       2.10726070       2.19277024       2.27624059       2.35785532       2.43778491       2.51604915       2.59297299       2.66859818    
 DCOOL:   768.351257       765.161072       761.943726       758.695251       755.418945       752.112000       748.771973       745.402832       722.719604       703.264954       683.223389       645.145264       604.526550       569.957520       540.125366       514.074585       491.091736       470.631470       452.274445       435.686218       420.601685       406.806976       394.149109       382.452911       371.610596    
 TCOOL:   544.049927       545.838257       547.615356       549.382751       551.138062       552.882202       554.615601       556.335632       558.367432       559.562256       560.671265       561.018616       561.011292       561.003662       560.995728       560.987427       560.978699       560.969604       560.960022       560.950012       560.939514       560.928589       560.917114       560.905151       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       2.57300157E-02   5.04202172E-02   7.63334781E-02  0.130037963      0.188232660      0.237760067      0.280500889      0.317824304      0.350752294      0.380066425      0.406367064      0.430133522      0.451745659      0.471509635      0.489644885      0.506402194      0.521936059    
 XFL:   0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       0.00000000       1.74785615E-03   3.61474790E-03   5.78150619E-03   1.06728915E-02   1.68290492E-02   2.29857750E-02   2.91432068E-02   3.53013910E-02   4.14603837E-02   4.76206131E-02   5.37814274E-02   5.99433333E-02   6.61062971E-02   7.22701177E-02   7.84350634E-02   8.46009329E-02   9.07678381E-02
 TSAT:   561.083313       561.077637       561.071960       561.066284       561.060608       561.054932       561.049316       561.043701       561.037781       561.031677       561.025452       561.018616       561.011292       561.003662       560.995728       560.987427       560.978699       560.969543       560.960022       560.950012       560.939514       560.928589       560.917114       560.905151       560.892639    
 MUT:   9.77394811E-05   9.69635948E-05   9.61961778E-05   9.54360803E-05   9.46838554E-05   9.39386227E-05   9.31997201E-05   9.24677952E-05   9.16042482E-05   9.10965391E-05   9.06252317E-05   9.05198758E-05   9.05226989E-05   9.05256456E-05   9.05287088E-05   9.05319102E-05   9.05352790E-05   9.05388151E-05   9.05424895E-05   9.05463530E-05   9.05504057E-05   9.05546185E-05   9.05590496E-05   9.05636698E-05   9.05685010E-05
 HCOOL:   1193675.62       1202818.50       1211961.38       1221104.25       1230247.25       1239390.12       1248533.00       1257675.75       1266818.62       1275961.38       1285104.12       1294247.00       1303389.88       1312532.75       1321675.75       1330818.62       1339961.50       1349104.25       1358247.12       1367390.00       1376532.88       1385675.75       1394818.62       1403961.50       1413104.38    
"""

raw_data_4= """PCOOL:   7230546.50       7229938.00       7229333.00       7228693.50       7228038.50       7227341.00       7226523.50       7225663.50       7224753.00       7223787.50       7222761.00       7221669.00       7220508.50       7219275.00       7217965.50       7216577.00       7215106.00       7213549.50       7211904.50       7210168.00       7208336.50       7206407.00       7204377.00       7202242.00       7200000.00    
 VCOOL:   1.29334688       1.30429351       1.31563377       1.36956787       1.41714597       1.49067843       1.64780414       1.79303622       1.92915261       2.05806279       2.18113208       2.29939055       2.41364479       2.52453303       2.63234329       2.73774934       2.84100032       2.94238091       3.04214859       3.14050579       3.23765182       3.33375168       3.42896056       3.52340150       3.61719275    
 DCOOL:   766.771484       760.335876       753.782471       724.098877       699.789307       665.263489       601.826294       553.085815       514.068237       481.873993       454.686279       431.296112       410.869263       392.806763       376.701172       362.176544       348.991455       336.943817       325.871002       315.643616       306.153625       297.311127       289.040466       281.278992       273.973083    
 TCOOL:   544.944275       548.499634       552.011292       556.457520       559.132202       561.150940       561.143188       561.135071       561.126526       561.117310       561.107727       561.097412       561.086426       561.074829       561.062439       561.049316       561.035400       561.020752       561.005188       560.988770       560.971436       560.953247       560.934021       560.913818       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       2.85268761E-02   5.64188175E-02  0.100914434      0.191836730      0.261695027      0.317618132      0.363761753      0.402729601      0.436254680      0.465532362      0.491421133      0.514504850      0.535322428      0.554219782      0.571486533      0.587355793      0.602012873      0.615612686      0.628283978      0.640135169      0.651256025      0.661723375    
 XFL:   0.00000000       0.00000000       0.00000000       1.87635352E-03   4.04399168E-03   7.97254965E-03   1.72887333E-02   2.63922215E-02   3.53540964E-02   4.42219861E-02   5.30279838E-02   6.17957972E-02   7.05411881E-02   7.92759135E-02   8.80100876E-02   9.67462361E-02  0.105489999      0.114243917      0.123010255      0.131788820      0.140580326      0.149385884      0.158206090      0.167040825      0.175889686    
 TSAT:   561.181152       561.175415       561.169739       561.163696       561.157471       561.150940       561.143188       561.135071       561.126526       561.117371       561.107727       561.097412       561.086426       561.074768       561.062439       561.049316       561.035400       561.020752       561.005188       560.988770       560.971436       560.953247       560.934021       560.913818       560.892639    
 MUT:   9.73543865E-05   9.58192104E-05   9.43144987E-05   9.24204505E-05   9.12840042E-05   9.04688131E-05   9.04718036E-05   9.04749395E-05   9.04782355E-05   9.04817643E-05   9.04854824E-05   9.04894623E-05   9.04937042E-05   9.04982080E-05   9.05029592E-05   9.05080233E-05   9.05134002E-05   9.05190464E-05   9.05250563E-05   9.05313937E-05   9.05380875E-05   9.05451016E-05   9.05525230E-05   9.05603229E-05   9.05685010E-05
 HCOOL:   1202818.50       1221105.00       1239391.50       1256935.00       1274332.00       1290922.00       1304767.25       1318294.62       1331609.62       1344782.50       1357861.88       1370882.00       1383866.75       1396833.62       1409797.88       1422762.75       1435736.88       1448724.50       1461728.25       1474748.25       1487785.38       1500841.88       1513918.00       1527014.00       1540129.38    
"""

#friction churchill
raw_data_4c="""PCOOL:   7238707.50       7238099.50       7237494.00       7236853.50       7236195.50       7235457.50       7234571.50       7233621.00       7232595.00       7231483.50       7230277.50       7228970.50       7227556.00       7226027.00       7224378.00       7222603.00       7220697.00       7218653.50       7216467.00       7214132.00       7211641.50       7208990.00       7206170.50       7203176.00       7200000.00    
 VCOOL:   1.29332864       1.30427277       1.31561291       1.37010741       1.41898739       1.52459574       1.72744417       1.91655183       2.09445763       2.26316833       2.42430139       2.57917309       2.72856545       2.87360907       3.01490617       3.15305305       3.28855109       3.42182803       3.55325937       3.68316627       3.81183267       3.93950272       4.06640339       4.19272900       4.31864500    
 DCOOL:   766.782593       760.347595       753.794373       723.815430       698.882812       650.480469       574.097595       517.450989       473.497498       438.199371       409.073792       384.510223       363.457458       345.112030       328.937439       314.525024       301.565521       289.819550       279.099213       269.254913       260.165833       251.733856       243.877274       236.528885       229.631760    
 TCOOL:   544.944763       548.500061       552.011963       556.595581       559.420410       561.227478       561.219116       561.210144       561.200500       561.190002       561.178589       561.166321       561.152954       561.138550       561.122986       561.106201       561.088196       561.068909       561.048279       561.026245       561.002686       560.977661       560.950989       560.922668       560.892639    
 EPS:   0.00000000       0.00000000       0.00000000       2.85868179E-02   5.70075400E-02  0.121926486      0.231430337      0.312639982      0.375652611      0.426256627      0.468011618      0.503226042      0.533407152      0.559706509      0.582893312      0.603553355      0.622129858      0.638965964      0.654330969      0.668439329      0.681464136      0.693545997      0.704801977      0.715328395      0.725206733    
 XFL:   0.00000000       0.00000000       0.00000000       1.88527524E-03   4.11142269E-03   9.93153732E-03   2.22331136E-02   3.45358364E-02   4.68398444E-02   5.91456480E-02   7.14532435E-02   8.37622508E-02   9.60734189E-02  0.108386189      0.120700978      0.133017674      0.145336002      0.157656029      0.169977725      0.182300940      0.194625914      0.206952021      0.219279692      0.231608450      0.243938401    
 TSAT:   561.258057       561.252380       561.246643       561.240601       561.234436       561.227478       561.219116       561.210144       561.200500       561.190002       561.178589       561.166321       561.152954       561.138550       561.122986       561.106201       561.088196       561.068909       561.048279       561.026245       561.002686       560.977661       560.950989       560.922668       560.892639    
 MUT:   9.73567803E-05   9.58217061E-05   9.43169653E-05   9.23646439E-05   9.11645620E-05   9.04392873E-05   9.04425106E-05   9.04459739E-05   9.04496919E-05   9.04537446E-05   9.04581466E-05   9.04628760E-05   9.04680346E-05   9.04735934E-05   9.04795961E-05   9.04860790E-05   9.04930203E-05   9.05004636E-05   9.05084235E-05   9.05169290E-05   9.05260240E-05   9.05356792E-05   9.05459747E-05   9.05569104E-05   9.05685010E-05
 HCOOL:   1202818.50       1221104.25       1239389.88       1257675.75       1275961.50       1294247.25       1312533.00       1330818.75       1349104.50       1367390.38       1385676.12       1403961.88       1422247.62       1440533.25       1458819.00       1477104.75       1495390.50       1513676.25       1531962.00       1550247.75       1568533.50       1586819.25       1605105.12       1623390.75       1641676.62    
"""

z, TempVap, TempLiq, TempFuelC, TempStru, Void, Pressure, VelzVap, VelzLiq, VelzMoy = [], [], [], [], [], [], [], [], [], []

# Traitement de chaque ligne pour extraire les valeurs numériques
def extraire(var_name, line_nb, data_name):
    data_lines = data_name.strip().split("\n")
    values = data_lines[line_nb].split(":")[1]
    # Séparation des valeurs en une liste de flottants
    for value in values.split():
        var_name.append(float(value))
    return

# Valeurs THM sans Chruchill
PCOOL0=[]
PCOOL1=[]
PCOOL2=[]
PCOOL4=[]
extraire(PCOOL0, 0, raw_data_0)
extraire(PCOOL1, 0, raw_data_1)
extraire(PCOOL2, 0, raw_data_2)
extraire(PCOOL4, 0, raw_data_4)

VCOOL0=[]
VCOOL1=[]
VCOOL2=[]
VCOOL4=[]
extraire(VCOOL0, 1, raw_data_0)
extraire(VCOOL1, 1, raw_data_1)
extraire(VCOOL2, 1, raw_data_2)
extraire(VCOOL4, 1, raw_data_4)

EPS0=[]
EPS1=[]
EPS2=[]
EPS4=[]
extraire(EPS0, 4, raw_data_0)
extraire(EPS1, 4, raw_data_1)
extraire(EPS2, 4, raw_data_2)
extraire(EPS4, 4, raw_data_4)

TCOOL0=[]
TCOOL1=[]
TCOOL2=[]
TCOOL4=[]
extraire(TCOOL0, 3, raw_data_0)
extraire(TCOOL1, 3, raw_data_1)
extraire(TCOOL2, 3, raw_data_2)
extraire(TCOOL4, 3, raw_data_4)

VCOOL=[VCOOL4, VCOOL2, VCOOL1, VCOOL0]
PCOOL=[PCOOL4, PCOOL2, PCOOL1, PCOOL0]
EPS=[EPS4, EPS2, EPS1, EPS0]
TCOOL=[TCOOL4, TCOOL2, TCOOL1, TCOOL0]

# Valeurs THM avec Churchill
PCOOL0c=[]
PCOOL1c=[]
PCOOL2c=[]
PCOOL4c=[]  
extraire(PCOOL0c, 0, raw_data_0c)
extraire(PCOOL1c, 0, raw_data_1c)
extraire(PCOOL2c, 0, raw_data_2c)
extraire(PCOOL4c, 0, raw_data_4c)
VCOOL0c=[]
VCOOL1c=[]
VCOOL2c=[]
VCOOL4c=[]
extraire(VCOOL0c, 1, raw_data_0c)
extraire(VCOOL1c, 1, raw_data_1c)   
extraire(VCOOL2c, 1, raw_data_2c)
extraire(VCOOL4c, 1, raw_data_4c)
EPS0c=[]
EPS1c=[]
EPS2c=[]
EPS4c=[]
extraire(EPS0c, 4, raw_data_0c)
extraire(EPS1c, 4, raw_data_1c)
extraire(EPS2c, 4, raw_data_2c)
extraire(EPS4c, 4, raw_data_4c)
TCOOL0c=[]
TCOOL1c=[]
TCOOL2c=[]
TCOOL4c=[]
extraire(TCOOL0c, 3, raw_data_0c)
extraire(TCOOL1c, 3, raw_data_1c)
extraire(TCOOL2c, 3, raw_data_2c)
extraire(TCOOL4c, 3, raw_data_4c)
VCOOLc=[VCOOL4c, VCOOL2c, VCOOL1c, VCOOL0c]
PCOOLc=[PCOOL4c, PCOOL2c, PCOOL1c, PCOOL0c]
EPSc=[EPS4c, EPS2c, EPS1c, EPS0c]
TCOOLc=[TCOOL4c, TCOOL2c, TCOOL1c, TCOOL0c]


powers = [4,2,1,0]
powerskW = [38.4, 19.2, 9.6, 3.8]

for i in powers:
    X = readTPF(rf"THM_prototype/TPF/graph_axial_{i}e9W.txt")
    z.append(X[0])
    TempVap.append(X[1])
    TempLiq.append(X[2])
    TempFuelC.append(X[3])
    TempStru.append(X[4])
    Void.append(X[5])
    Pressure.append(X[6])
    VelzVap.append(X[7])
    VelzLiq.append(X[8])
    VelzMoy.append(0)

colors = ['blue', 'red', 'green', 'orange']

fig, ax = plt.subplots()
for i in range(len(z)):
    #ax.step(caseMerge[i].convection_sol.z_mesh, caseMerge[i].convection_sol.T_water, label=f"THM_p {powerskW[i]} kW", color=colors[i])
    #ax.step(z[i], TempVap[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax.step(z[i], TCOOL[i], label=f"THM {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax.step(z[i], TempLiq[i], label=f"TPF {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax.step(z[i], TCOOLc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax.set_xlabel("Axial position in m")
ax.set_ylabel("Temperature in K")
ax.grid()
ax.legend(loc="best")
plt.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_temp.png', bbox_inches='tight')

fig1, ax1 = plt.subplots()
for i in range(len(z)):
    #ax1.step(caseMerge[i].convection_sol.z_mesh, caseMerge[i].convection_sol.voidFraction[-1], label=f"THM_p {powerskW[i]} kW", color=colors[i])
    ax1.step(z[i], EPS[i], label=f"THM {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax1.step(z[i], Void[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax1.step(z[i], EPSc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax1.set_xlabel("Axial position in m")
ax1.set_ylabel("Void fraction")
ax1.grid()
ax1.legend(loc="best")
fig1.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_void.png', bbox_inches='tight')

fig2, ax2 = plt.subplots()
for i in range(len(z)):
    #ax2.step(caseMerge[i].convection_sol.z_mesh, caseMerge[i].convection_sol.P[-1], label=f"THM_p {powerskW[i]} kW", color=colors[i])
    ax2.step(z[i], PCOOL[i], label=f"THM {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax2.step(z[i], Pressure[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax2.step(z[i], PCOOLc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax2.set_xlabel("Axial position in m")
ax2.set_ylabel("Pressure in Pa")
ax2.grid()
ax2.legend(loc="best")
fig2.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_pressure.png', bbox_inches='tight')

fig21, ax21 = plt.subplots()
for i in (0,1):
    ax21.step(z[i], PCOOL[i], label=f"THM {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax21.step(z[i], Pressure[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax21.step(z[i], PCOOLc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax21.set_xlabel("Axial position in m")
ax21.set_ylabel("Pressure in Pa")   
ax21.grid()
ax21.legend(loc="best")
fig21.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_pressure_1.png', bbox_inches='tight')

fig22, ax22 = plt.subplots()
for i in (2,3):
    ax22.step(z[i], PCOOL[i], label=f"THM {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax22.step(z[i], Pressure[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax22.step(z[i], PCOOLc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax22.set_xlabel("Axial position in m")
ax22.set_ylabel("Pressure in Pa")
ax22.grid()
ax22.legend(loc="best")
fig22.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_pressure_2.png', bbox_inches='tight')


fig3, ax3 = plt.subplots()
for i in range(len(z)):
    VelzMoy[i] = VelzVap[i]*(1-Void[i]) + VelzLiq[i]*Void[i]
    #ax3.step(caseMerge[i].convection_sol.z_mesh, caseMerge[i].convection_sol.Ul, label=f"THM_p {powerskW[i]} kW", color=colors[i])
    ax3.step(z[i], VCOOL[i], label=f"THM {powerskW[i]} kW", linestyle='-', color = colors[i])
    ax3.step(z[i], VelzMoy[i], label=f"TPF {powerskW[i]} kW", linestyle='--', color = colors[i])
    ax3.step(z[i], VCOOLc[i], label=f"THM_churchill {powerskW[i]} kW", linestyle=':', color = colors[i])
ax3.set_xlabel("Axial position in m")
ax3.set_ylabel("Coolant velocity in m/s")
ax3.grid()
ax3.legend(loc="best")
fig3.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_velocity.png', bbox_inches='tight')

fig4, ax4 = plt.subplots()
for i in range(len(z)):
    #ax4.step(caseMerge[i].convection_sol.z_mesh, caseMerge[i].convection_sol.Ug, label=f"THM_p {powerskW[i]} kW", color=colors[i])
    ax4.step(z[i], VelzVap[i], label=f"TPF {powerskW[i]} kW", linestyle='-', color = colors[i])
ax4.set_xlabel("Axial position in m")
ax4.set_ylabel("Vapor velocity in m/s")
ax4.grid()
ax4.legend(loc="best")
fig4.savefig(rf'/home/p122173/Version5_BWR/Version5_ev3727/Donjon/data/results_marie/TPF_THM_velocity_vapor.png', bbox_inches='tight')


# Calcul des différences point par point
for i in range(len(PCOOL)):
    diffsP = [a - b for a, b in zip(PCOOL[i], Pressure[i])]
    diffsPc =[a - b for a, b in zip(PCOOLc[i], Pressure[i])]
    diffsT = [a - b for a, b in zip(TCOOL[i], TempLiq[i])]
    diffsTc =[a - b for a, b in zip(TCOOLc[i], TempLiq[i])]
    diffsV = [a - b for a, b in zip(VCOOL[i], VelzMoy[i])]
    diffsVc =[a - b for a, b in zip(VCOOLc[i], VelzMoy[i])]
    diffsE = [a - b for a, b in zip(EPS[i], Void[i])]  
    diffsEc =[a - b for a, b in zip(EPSc[i], Void[i])]

    # RMS deviation in %
    rms_deviation_P = np.sqrt(sum(d**2 for d in diffsP) / len(diffsP))/np.mean(Pressure[i])*100
    rms_deviation_Pc = np.sqrt(sum(d**2 for d in diffsPc) / len(diffsPc))/np.mean(Pressure[i])*100
    rms_deviation_T = np.sqrt(sum(d**2 for d in diffsT) / len(diffsT))/np.mean(TempLiq[i])*100
    rms_deviation_Tc = np.sqrt(sum(d**2 for d in diffsTc) / len(diffsTc))/np.mean(TempLiq[i])*100
    rms_deviation_V = np.sqrt(sum(d**2 for d in diffsV) / len(diffsV))/np.mean(VelzMoy[i])*100
    rms_deviation_Vc = np.sqrt(sum(d**2 for d in diffsVc) / len(diffsVc))/np.mean(VelzMoy[i])*100
    rms_deviation_E = np.sqrt(sum(d**2 for d in diffsE) / len(diffsE))*100
    rms_deviation_Ec = np.sqrt(sum(d**2 for d in diffsEc) / len(diffsEc))*100
    # Max deviation in %
    max_deviation_P = max(abs(d) for d in diffsP)/np.mean(Pressure[i])*100
    max_deviation_Pc = max(abs(d) for d in diffsPc)/np.mean(Pressure[i])*100
    max_deviation_T = max(abs(d) for d in diffsT)/np.mean(TempLiq[i])*100
    max_deviation_Tc = max(abs(d) for d in diffsTc)/np.mean(TempLiq[i])*100
    max_deviation_V = max(abs(d) for d in diffsV)/np.mean(VelzMoy[i])*100
    max_deviation_Vc = max(abs(d) for d in diffsVc)/np.mean(VelzMoy[i])*100
    max_deviation_E = max(abs(d) for d in diffsE)*100
    max_deviation_Ec = max(abs(d) for d in diffsEc)*100

    # Affichage des résultats
    print(powerskW[i], "kW") 
    print(f"RMS Deviation Pressure wo C : {rms_deviation_P:.4f}")
    print(f"Max Deviation Pressure wo C : {max_deviation_P:.4f}")
    print(f"RMS Deviation Pressure w C : {rms_deviation_Pc:.4f}")
    print(f"Max Deviation Pressure w C : {max_deviation_Pc:.4f}")
    print(f"RMS Deviation Temperature wo C : {rms_deviation_T:.4f}")
    print(f"Max Deviation Temperature wo C : {max_deviation_T:.4f}")
    print(f"RMS Deviation Temperature w C : {rms_deviation_Tc:.4f}")
    print(f"Max Deviation Temperature w C : {max_deviation_Tc:.4f}")
    print(f"RMS Deviation Velocity wo C : {rms_deviation_V:.4f}")
    print(f"Max Deviation Velocity wo C : {max_deviation_V:.4f}")
    print(f"RMS Deviation Velocity w C : {rms_deviation_Vc:.4f}")
    print(f"Max Deviation Velocity w C : {max_deviation_Vc:.4f}")
    print(f"RMS Deviation Void wo C : {rms_deviation_E:.4f}")
    print(f"Max Deviation Void wo C : {max_deviation_E:.4f}")
    print(f"RMS Deviation Void w C : {rms_deviation_Ec:.4f}")
    print(f"Max Deviation Void w C : {max_deviation_Ec:.4f}")


plt.show()


